source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/.active-rstudio-document')
Î¸= 0.0528
theta=0.0528
sai=2*theta*(1-theta)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
0.25*0.5*0.5*0.5*0.5*0.8*0.5^4*(0.25*2*0.5^4+0.5*0.5^3*0.18)*0.25
L0=0.25*0.5*0.5*0.5*0.5*0.8*0.5^4*(0.25*2*0.5^4+0.5*0.5^3*0.18)*0.25
L0=0.25*0.5*0.5*0.5*0.5*0.8/0.91*0.5^4*(0.25*2*0.5^4+0.5*0.5^3*0.18)*0.25
L2=0.25*0.5^4*0.01/0.91*0.5*0.5*(0.25*2*0.5^4+0.5*0.5^3*0.18)*0.25
L1=0.25*0.5^4*0.18/(1+2*sai-2*sai^2)*0.5^3*(0.25*2*0.5^4*0.09+0.5*0.5^3*(sai^2+(1-sai)^2))*0.5
L0/(L0+L1+L2)
L1/(L0+L1+L2)
L2/(L0+L1+L2)
0.5^4+0.5^3+0.5^2
0.375/0.4375
0.5^3/(0.5^3+2*0.5^4)
0.44-0.66*0.74
0.32-0.52*0.78
0.52*0.78
0.66*0.74
-0.0484/0.4884
-0.0856/0.4056
38*log10(0.38)+21*log10(0.21)+28*log10(0.28)+13*log10(0.13)
22*log10(0.44)+11*log10(0.22)+15*log10(0.3)+2*log10(0.04)+16*log10(0.32)+10*log10(0.2)+13*log10(0.26)+11*log10(0.22)
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/.active-rstudio-document')
source('~/R/BIOSTAT666/HW2/Q2c_em.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
install.packages("ggplot2")
?aes
?aes()
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
?aes
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
ReportQuality
?xlab
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
ReportQuality
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
mydata[,1]
mydata[,1:40]
mydata[,1][1:40]
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
Cycle
EmpericalQuality1
EmpericalQuality2
ReportQuality
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
?geom_line
?geom_point
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
?typeof
typeof(Cycle)
typeof(mydata)
typeof(mydata[,2])
typeof(mydata[1,2])
typeof(mydata[,1:2])
mydata[1:40,2]
mydata[1:40,1]
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
q2=ggplot(mydata,aes(y=EmpericalQuality1,x=Cycle))+geom_point()+ggtitle("EmpCycleDist")+xlim(0,100)+ylim(0,80)+ylab('EmpericalQuality')
q2
?geom_point
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
mydata[1:100,,,]
mydata[1:100,]
mydata[1:100,1]
mydata[1:100,2]
mydata[1:100,3]
mydata
mydata= read.table(paste(input,".EmpCycleDist",sep=""),header=FALSE);
mydata[1:100,,]
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
mydata=mydata[1:40,,,];
mydata
mydata[1:40,]
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
dev.off()
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
?max
max(c(1,2,3,4,5))
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
mydata[18]
mydata[19]
mydata[20]
mydata[22]
mydata[21]
mydata[23]
mydata[24]
mydata[25]
mydata[26]
strsplit(mydata[21],":")
strsplit(mydata[21],":")[[1]]
strsplit(mydata[21],":")[[2]]
strsplit(mydata[21],":")[1
d
strsplit(mydata[21],":")[1]
strsplit(mydata[21],":")[0]
strsplit(mydata[21],":")[2]
strsplit(mydata[21],":")[1][1]
strsplit(mydata[21],":")[2][1]
strsplit(mydata[21],":")[1][1]
strsplit(mydata[21],":")[1]
strsplit(mydata[21],":")[1][1]
strsplit(mydata[21],":")[[1]]
strsplit(mydata[21],":")[[1]][1]
strsplit(mydata[21],":")[[1]][2]
as.numeric(strsplit(mydata[21],":")[[1]][2])
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
Depth10
Depth1
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
mydata <- scan(paste(input,".summary",sep=""), what="", sep="\n")
ExpectedDepth=as.numeric(strsplit(mydata[14]," ")[[1]][5])
EstimatedDepth=as.numeric(strsplit(mydata[14]," ")[[1]][5])
AccessibleFraction=as.numeric(strsplit(strsplit(mydata[16]," ")[[1]][8],"/")[[1]][1]);
EstimatedQ20Depth=as.numeric(strsplit(mydata[17]," ")[[1]][7]);
EstimatedQ30Depth=as.numeric(strsplit(mydata[18]," ")[[1]][7]);
Q20BaseFraction=as.numeric(strsplit(mydata[21],":")[[1]][2]);
Q30BaseFraction=as.numeric(strsplit(mydata[22],":")[[1]][2]);
Depth1=as.numeric(strsplit(mydata[23],":")[[1]][2]);
Depth2=as.numeric(strsplit(mydata[24],":")[[1]][2]);
Depth5=as.numeric(strsplit(mydata[25],":")[[1]][2]);
Depth10=as.numeric(strsplit(mydata[26],":")[[1]][2]);
plotdata=c(ExpectedDepth,EstimatedDepth,EstimatedQ20Depth,EstimatedQ30Depth)
plotname=c("ExpectedDepth","EstimatedDepth","EstimatedQ20Depth","EstimatedQ30Depth")
mydate=cbind(read.table(text=plotname),plotdata)
q6=ggplot(mydate,aes(x=mydate[,1],y=mydate[,2]))+ggtitle("Depth")+scale_x_discrete(limits=c("ExpectedDepth","EstimatedDepth","EstimatedQ20Depth","EstimatedQ30Depth"))+geom_bar(stat="identity",fill="Sky Blue")+xlab('Stat')+ylab('Depth')#+xlim(0,length(plotdata)+1)+ylim(0,max(plotdata));
plotdata2=c(Q20BaseFraction,Q30BaseFraction,Depth1,Depth2,Depth5,Depth10)
plotname2=c("Q20","Q30","Depth 1","Depth 2","Depth 5","Depth 10")
mydata2=cbind(read.table(text=plotname2),plotdata2)
length(plotname2)
length(plotdata2)
tab = cbind(plotname2,plotdata2)
tab
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
tab = as.data.frame(plotname2,plotdata2)
tab = data.frame(plotname2,plotdata2)
tab
mydata2=data.frame(plotname2,plotdata2)
mydata2=data.frame(plotname2,plotdata2)
q7=ggplot(mydata2,aes(x=mydata2[,1],y=mydata2[,2]))+ggtitle("Base Fraction Summary")+scale_x_discrete(limits=c("Q20","Q30","Depth 1","Depth 2","Depth 5","Depth 10"))+geom_bar(stat="identity",fill="Sky Blue")+xlab('Stat')+ylab('Fraction')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/workingspace/FastqA/FastPopCon/FastqA/bin/RPlotScript.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Pr_Geno_IBD(c(1,1),c(1,1),1)
Pr_Geno_IBD(c(1,1),c(1,1),2)
Pr_Geno_IBD(c(1,1),c(1,1),3)
Pr_Geno_IBD(c(1,1),c(1,2),3)
Pr_Geno_IBD(c(1,1),c(1,2),2)
Pr_Geno_IBD(c(1,1),c(1,2),1)
Pr_Geno_IBD(c(1,1),c(2,2),1)
Pr_Geno_IBD(c(1,1),c(2,2),2)
Pr_Geno_IBD(c(1,1),c(2,2),3)
Pr_Geno_IBD(c(1,2),c(1,2),3)
Pr_Geno_IBD(c(1,2),c(1,2),2)
Pr_Geno_IBD(c(1,2),c(1,2),1)
Pr_Geno_IBD(c(1,2),c(2,2),1)
Pr_Geno_IBD(c(1,2),c(2,2),2)
Pr_Geno_IBD(c(1,2),c(2,2),0)
Pr_Geno_IBD(c(1,2),c(2,2),3)
Pr_Geno_IBD(c(2,2),c(2,2),3)
Pr_Geno_IBD(c(2,2),c(2,2),2)
Pr_Geno_IBD(c(2,2),c(2,2),1)
Trans
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
Pr_Geno_IBD(c(1,1),c(1,1),1)
Pr_Geno_IBD(c(1,1),c(1,1),1)*Pr_Geno_IBD(c(1,1),c(2,2),1)*Pr_Geno_IBD(c(1,1),c(1,1),1)*alpha1[1]
Pr_Geno_IBD(c(1,1),c(1,1),2)*Pr_Geno_IBD(c(1,1),c(2,2),2)*Pr_Geno_IBD(c(1,1),c(1,1),2)*alpha1[2]
Pr_Geno_IBD(c(1,1),c(1,1),3)*Pr_Geno_IBD(c(1,1),c(2,2),3)*Pr_Geno_IBD(c(1,1),c(1,1),2)*alpha1[3]
Pr_Geno_IBD(c(1,1),c(1,1),1)
Pr_Geno_IBD(c(1,1),c(1,1),1)^3
Pr_Geno_IBD(c(1,1),c(1,1),1)^3*1/4
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
alpha1[1]
alpha2[1]
alpha2(1)
alpha2(3)
alpha3(1)
alpha3(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)
L1=alpha3(1)*Pr_Geno_IBD(c(1,1),c(1,1),1);
L2=alpha3(2)*Pr_Geno_IBD(c(1,1),c(1,1),2);
L3=alpha2(3)*Pr_Geno_IBD(c(1,1),c(1,1),3);
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
alpha2(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)*Trans[1,j]
alpha2(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)*Trans[1,1]
alpha2(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)*Trans[1,2]
alpha2(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)*Trans[1,3]
alpha3(1)
0.0625^3
0.0625^3/4
alpha3(1)*Pr_Geno_IBD(c(1,1),c(1,1),1)
alpha3(2)*Pr_Geno_IBD(c(1,1),c(1,1),2)
Trans[1,2]
Trans[2,2]
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
sum(Trans(1,:))
sum(Trans[1,:])
sum(Trans[1,])
sum(Trans[2,])
sum(Trans[4,])
sum(Trans[3,])
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Tran
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
pji
phi
2*phi^2+2*(1-phi)^2
phi
phi^2
phi^2*2
(1-phi)^2
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
Trans
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
source('C:/Users/PC/Dropbox/Homework/biostat666/HW#5.R')
getwd()
set("C:/Users/PC/Documents/R/test/")
setwd("C:/Users/PC/Documents/R/test/")
source('~/R/test/a10.run.pc.match.r')
install.packages("irlba")
source('~/R/test/a10.run.pc.match.r')
source('~/R/test/a10.run.pc.match.r')
randstart
res <- optim( randstart, pc.lik, gls=10^GL[,3*(i-1)+1:3], UD=UD, mu=r$mu, n=n, method="Nelder-Mead")
res <- optim( randstart, pc.lik, gls=10^GL[,3*(0)+1:3], UD=UD, mu=r$mu, n=n, method="Nelder-Mead")
10^GL[,3*(0)+1:3]
randstart <- V[1,]
res <- optim( randstart, pc.lik, gls=10^GL[,3*(i-1)+1:3], UD=UD, mu=r$mu, n=n, method="Nelder-Mead")
?optim
pc.lik(randstart,10^GL[,3*(i-1)+1:3],UD,r$mu,n)
n
r$mu
r$mu[1]
r$mu[1:2]
r$mu[1:2:3]
r$mu[1:3]
(UD%*%randstart+r$mu)/2
r$mu>0
r$mu>0==FALSE
(r$mu>0)==FALSE
UD%*%randstart
afs=(UD%*%randstart+r$mu)/2
afs[afs < 0.5/n] <- 0.5/n
afs[afs > (n-0.5)/n] <- (n-0.5)/n
gfs <- c((1-afs)*(1-afs), 2*afs*(1-afs), afs*afs)
sum(log(rowSums(gls * gfs)))
sum(log(rowSums( 10^GL[,3*(0)+1:3]* gfs)))
10^GL[,3*(0)+1:3]*gfs
rowSums(10^GL[,3*(0)+1:3]*gfs)
log(rowSums(10^GL[,3*(0)+1:3]*gfs))
rowSums(10^GL[,3*(0)+1:3]*gfs)[-3]
rowSums(10^GL[,3*(0)+1:3]*gfs)[-3]
gfs[-3]
10^GL[,3*(0)+1:3]
10^GL[,3*(0)+1:3][-3]
10^GL[,3*(0)+1:3]
10^GL[,3*(0)+1:3][-3,]
(10^GL[,3*(0)+1:3])[-3,1]
gfs
setwd('C:/Users/PC/Dropbox/Homework/stat500')
ship=read.csv(file = 'ships.csv')
ship
ship=ship[ship$service!=0]
colnames(ship)
ship=ship[ship[,"service"]!=0]
ship=read.csv(file = 'ships.csv',header=T)
ship=ship[ship[,"service"]!=0]
colnames(ship)
ship[,"service"]!=0
ship[ship[,"service"]!=0,]
ship=ship[ship[,"service"]!=0,]
m1=glm(accidents~type+year+period,offset(service),family=poisson,ship)
m1=glm(accidents~type+year+period,offset(service),family=poisson,data=ship)
summary(m1)
ship$type=factor(ship$type)
ship$year=factor(ship$year)
ship$period=factor(ship$period)
ship$year=factor(ship$year)
m1=glm(accidents~type+year+period,offset(service),family=poisson,data=ship)
summary(m1)
G2=sum(residuals(m1)^2)
qchisq(318960,25)
pchisq(318960,25)
1-pchisq(318960,25)
?pchisq
theta_hat=sum(residuals(m1,type = "pearson")^2)/25
summary(m1,dispersion = theta_hat)
exp(-0.01431-1.96*0.09171)
exp(-0.01431+1.96*0.09171)
names(summary(m1))
dose=c(-0.553,-0.113,0.059,0.185,0.446,0.753)
Ntotal=repeat(75,5)
?repeat
?repeat)
?repeat()
?rep()
Ntotal=rep(75,5)
Ntotal=rep(75,6)
Ndeath=c(0,14,29,42,67,73)
data.m=cbind(dose,Ntotal,Ndeath)
data.m
logp=log((Ndeath+1)/(Ntotal+1))
data.m=cbind(dose,Ntotal,Ndeath,logp)
h1=glm(logp~dose,data=data.m,family=binomial)
data.fm=as.data.frame(cbind(dose,Ntotal,Ndeath,logp))
h1=glm(logp~dose,data=data.fm,family=binomial)
logp
p=(Ndeath+1)/(Ntotal+1))
data.fm=as.data.frame(cbind(dose,Ntotal,Ndeath,p))
p=(Ndeath+1)/(Ntotal+1)
data.fm=as.data.frame(cbind(dose,Ntotal,Ndeath,p))
h1=glm(p~dose,data=data.fm,family=binomial)
p
h1=glm(data.fm[,2:3]~dose,data=data.fm,family=binomial)
h1=glm(cbind(Ntotal-Ndeath,Ndeath)~dose,data=data.fm,family=binomial)
summary(h1)
logits=log((Ndeath+1)/(Ntotal-Ndeath+1))
plot(dose,logits)
fitted.values(h1)
?intersect
?plot
?abline
?line
?plot
?rbinom
h1$coefficients
phat <- fitted.values(m1) #fitted proportions
m1=glm(cbind(Ntotal-Ndeath,Ndeath)~dose,data=data.fm,family=binomial)
summary(m1)
fitted.values(m1)
phat <- fitted.values(m1) #fitted proportions
ynew <- rbinom(6,75,phat) #generate binomial rv
for(i in 1:1000) { #do 1000 times
ynew <- rbinom(6,75,phat) #generate binomial rv
ymatnew <- cbind(ynew,n-ynew) #create response matrix
m2 <- glm(ymatnew~x,family=binomial) #fit logistic model
nmat[,i] <- m2$coef #put coefficients in matrix
}
for(i in 1:1000) { #do 1000 times
ynew <- rbinom(6,75,phat) #generate binomial rv
ymatnew <- cbind(ynew,75-ynew) #create response matrix
m2 <- glm(ymatnew~x,family=binomial) #fit logistic model
nmat[,i] <- m2$coef #put coefficients in matrix
}
m2 <- glm(ymatnew~dose,family=binomial) #fit logistic model
for(i in 1:1000) { #do 1000 times
ynew <- rbinom(6,75,phat) #generate binomial rv
ymatnew <- cbind(ynew,75-ynew) #create response matrix
m2 <- glm(ymatnew~dose,family=binomial) #fit logistic model
nmat[,i] <- m2$coef #put coefficients in matrix
}
phat <- fitted.values(m1) #fitted proportions
nmat <- matrix(0,nrow=2,ncol=1000) #2x1000 matrix
for(i in 1:1000) { #do 1000 times
ynew <- rbinom(6,75,phat) #generate binomial rv
ymatnew <- cbind(ynew,75-ynew) #create response matrix
m2 <- glm(ymatnew~dose,family=binomial) #fit logistic model
nmat[,i] <- m2$coef #put coefficients in matrix
}
LD50samp <- -nmat[1,]/nmat[2,] #calculate 1000 LD50s
hist(LD50samp) #make histogram
mean(LD50samp); sd(LD50samp) #take mean and sd
mean(LD50samp); sd(LD50samp) #take mean and sd
dose=c(-0.553,-0.113,0.059,0.185,0.446,0.753)
Ntotal=rep(75,6)
Ndeath=c(0,14,29,42,67,73)
data.fm=as.data.frame(cbind(dose,Ntotal,Ndeath))
logits=log((Ndeath+1)/(Ntotal-Ndeath+1))
plot(dose,logits)
m1=glm(cbind(Ndeath,Ntotal-Ndeath)~dose,data=data.fm,family=binomial)
summary(m1)
summary(m1)
vec <- c(-1/m1$coef[2], m1$coef[1]/m1$coef[2]^2)
sqrt(vec %*% vcov(m1) %*% vec)
setwd("E:/Dropbox/Projects/CellTypeTracking")
load(".RData")
load(".Rhistory")
